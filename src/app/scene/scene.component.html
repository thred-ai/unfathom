<div
  class="h-100 primary-background d-flex justify-content-between align-items-center img-hover {{
    selected == scene.id ? 'selected' : ''
  }}"
  *ngIf="scene && workflow"
  style="overflow: hidden"
  #top
>
  <div class="h-100 secondary-background" style="aspect-ratio: 1">
    <img
      *ngIf="scene!.images[0]; else noImage"
      class="w-100 h-100"
      style="object-fit: cover"
      [src]="scene!.images[0] | safeImgUrl"
    />

    <ng-template #noImage>
      <div
        class="w-100 h-100 d-flex justify-content-center align-items-center flex-column p-3"
      >
        <ion-icon class="primary-text h1" name="image-outline"></ion-icon>
        <span class="mt-2 h5 primary-text w-100 text-truncate text-center"
          >No Image</span
        >
      </div>
    </ng-template>
  </div>
  <!-- <img > -->

  <div
    class="h-100 w-100 p-3 d-inline-flex justify-content-start align-items-start flex-column border-table-left"
  >
    <div
      class="w-100 d-inline-flex justify-content-between align-items-center p-0"
      style="height: 35px !important"
    >
      <p class="text-truncate w-100 h-100 primary-text h4 px-0 m-0">
        {{ scene.name && scene.name != "" ? scene.name : "No Title" }}
      </p>

      <!-- <ion-input
        class="text-truncate w-100 h-100 primary-text h4 px-0 m-0"
        fill="solid"
        [ngModel]="scene.name"
        [disabled]="true"
        [placeholder]="'Name'"
        (ngModelChange)="scene.name = $event; changed.emit(scene)"
      ></ion-input> -->

      <!-- <mat-icon class="primary-text">
        edit
      </mat-icon> -->
    </div>

    <p
      class="w-100 secondary-text mt-2 h-100"
      style="overflow-y: hidden; flex-shrink: 1; flex-grow: 0"
    >
      {{
        scene.description && scene.description != ""
          ? scene.description
          : "No Description"
      }}
    </p>
    <div
      class="d-flex justify-content-between align-items-center mb-auto mt-3 w-100"
      style="flex-shrink: 0; flex-grow: 1"
    >
      <div
        class="position-relative"
        style="height: 30px; min-width: 30px"
        placement="bottom"
        trigger="hover"
        role="button"
        [mdbPopover]="template"
      >
        <div
          class="nft-img h-100 bg-white shadow rounded-circle d-flex justify-content-center align-items-center position-absolute"
          style="
            object-fit: contain;
            aspect-ratio: 1;
            top: 0px;
            left: 0px;
            overflow: hidden;
            z-index: 50;
          "
          *ngIf="characters[0]; else emptyModel"
        >
          <div
            class="m-auto rounded-circle bg-black d-flex justify-content-center align-content-center"
            style="height: 90%; width: 90%; overflow: hidden"
          >
            <img
              class="w-100 h-100"
              style="object-fit: contain; overflow: hidden"
              [src]="characters[0].img"
              role="button"
            />
          </div>
        </div>
        <div
          class="nft-img h-100 bg-white shadow rounded-circle d-flex justify-content-center align-items-center position-absolute"
          *ngIf="(characters.length ?? 0) > 1"
          style="
            object-fit: contain;
            aspect-ratio: 1;
            top: 0px;
            left: 25px;
            overflow: hidden;
            z-index: 49;
          "
        >
          <img
            class="m-auto rounded-circle"
            style="
              object-fit: contain;
              height: 90%;
              width: 90%;
              overflow: hidden;
            "
            [src]="characters[1].img"
          />
        </div>
        <div
          class="nft-img h-100 bg-white shadow rounded-circle d-flex justify-content-center align-items-center position-absolute"
          *ngIf="(characters.length ?? 0) > 2"
          style="
            object-fit: contain;
            aspect-ratio: 1;
            top: 0px;
            left: 50px;
            overflow: hidden;
            z-index: 48;
          "
        >
          <img
            class="m-auto rounded-circle"
            style="
              object-fit: contain;
              height: 90%;
              width: 90%;
              overflow: hidden;
            "
            [src]="characters[2].img"
          />
        </div>

        <ng-template #emptyModel>
          <!-- 
          <div
            class="w-100 h-100 d-flex justify-content-center align-content-center"
          >
            <span class="my-auto secondary-text"> No Characters </span>
          </div> -->
        </ng-template>
      </div>


        <mat-icon
        class="secondary-text"
        role="button"
        (click)="selectWorld()"
        placement="bottom"
        trigger="hover"
        [mdbPopover]="template2"
        
      >
        open_in_new
      </mat-icon>
    
      
    </div>
  </div>
</div>

<ng-template #template>
  <div
    class="popover-body-padding primary-background rounded px-3"
    style="min-width: 200px"
    *ngIf="characters.length > 0"
  >
    <b class="mb-4 primary-text h5">Characters</b>

    <div class="w-100 mt-3">
      <div
        *ngFor="let n of characters ?? []"
        class="d-flex justify-content-between align-items-center py-1"
      >
        <div
          class="bg-white rounded-circle shadow d-flex justify-content-center align-items-center"
          style="
            object-fit: contain;
            aspect-ratio: 1;
            overflow: hidden;
            width: 30px;
          "
        >
          <img
            class="m-auto rounded-circle"
            style="object-fit: contain; height: 90%; width: 90%"
            [src]="n.img"
          />
        </div>
        <span class="w-100 ps-2 primary-text fw-normal h6 my-auto ms-1">
          {{ n.name }}
        </span>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #template2>
  <div
    class="popover-body-padding primary-background rounded px-3"
  >
    <p class="primary-text p">Open World</p>
  </div>
</ng-template>
